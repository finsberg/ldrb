Search.setIndex({"docnames": ["README", "basis_functions", "demo_biv", "demo_lifex_idealized_LV", "demo_lifex_strocchi_LV", "demo_lv", "demo_patient_lv", "ldrb", "modules"], "filenames": ["README.md", "basis_functions.md", "demo_biv.md", "demo_lifex_idealized_LV.md", "demo_lifex_strocchi_LV.md", "demo_lv.md", "demo_patient_lv.md", "ldrb.rst", "modules.rst"], "titles": ["Laplace-Dirichlet Rule-Based (LDRB) algorithm for assigning myocardial fiber orientations", "Local basis functions", "Creating fibers on a simple BiV ellipsoid", "Life X - idealized_LV", "Life X - 01_strocchi_LV", "Creating fibers on a simple LV ellipsoid", "Generating fibers for patient specific geometries", "ldrb package", "ldrb"], "terms": {"A": [0, 1, 2, 5, 7], "softwar": 0, "bayer": [0, 7], "j": 0, "d": 0, "blake": 0, "r": [0, 2, 5], "c": 0, "plank": 0, "g": [0, 2, 4, 5], "trayanova": 0, "n": [0, 4, 7], "2012": 0, "novel": 0, "comput": [0, 2, 3, 4, 5, 7], "heart": 0, "model": 0, "annal": 0, "biomed": 0, "engin": 0, "40": [0, 4, 7], "10": [0, 3, 4, 7], "pp": 0, "2243": 0, "2254": 0, "http": [0, 3, 4, 6], "www": 0, "ncbi": 0, "nlm": 0, "nih": 0, "gov": 0, "pmc": 0, "articl": 0, "pmc3518842": 0, "gener": [0, 1, 2, 5], "an": [0, 1, 2, 4, 5, 6, 7], "exampl": [0, 1, 3, 4, 6, 7], "geometri": [0, 1, 2, 4, 5, 7], "us": [0, 1, 2, 3, 4, 5, 6, 7], "github": 0, "com": 0, "computationalphysiolog": 0, "cardiac_geometri": [0, 2, 3, 4, 5, 6], "import": [0, 1, 2, 3, 4, 5, 6], "cardiac": [0, 1, 2, 4, 5], "geo": 0, "mesh": [0, 1, 2, 3, 4, 5, 6, 7], "create_biv_ellipsoid": [0, 2], "char_length": [0, 2], "0": [0, 1, 2, 3, 4, 5, 6, 7], "2": [0, 1, 2, 4, 5, 7], "decid": [0, 5], "angl": [0, 1, 2, 3, 4, 5, 6, 7], "you": [0, 1, 2, 3, 4, 5, 6, 7], "want": [0, 2, 4, 5, 7], "dict": [0, 5, 6, 7], "alpha_endo_lv": [0, 1, 2, 3, 4, 5, 6, 7], "30": [0, 2, 7], "lv": [0, 1, 2, 3, 4, 6, 7], "endocardium": [0, 2, 3, 4, 5, 6, 7], "alpha_epi_lv": [0, 1, 2, 3, 4, 5, 6, 7], "epicardium": [0, 2, 3, 4, 5, 6, 7], "beta_endo_lv": [0, 1, 2, 3, 4, 5, 6, 7], "sheet": [0, 2, 3, 4, 5, 6, 7], "beta_epi_lv": [0, 1, 2, 3, 4, 5, 6, 7], "alpha_endo_sept": [0, 2, 7], "60": [0, 2, 3, 4, 5, 6], "septum": [0, 2, 7], "alpha_epi_sept": [0, 2, 7], "beta_endo_sept": [0, 2, 7], "beta_epi_sept": [0, 2, 7], "alpha_endo_rv": [0, 2, 7], "80": [0, 2], "rv": [0, 1, 2, 5, 6, 7], "alpha_epi_rv": [0, 2, 7], "beta_endo_rv": [0, 2, 7], "beta_epi_rv": [0, 2, 7], "convert": [0, 3, 4, 6, 7], "marker": [0, 1, 2, 3, 4, 5, 6, 7], "correct": 0, "format": [0, 3, 4], "endo_lv": [0, 2], "endo_rv": [0, 2], "epi": [0, 2, 3, 4, 5, 6, 7], "choos": [0, 2, 5], "space": [0, 1, 2, 5, 6, 7], "field": [0, 1, 2, 5, 7], "thi": [0, 1, 2, 3, 4, 5, 6, 7], "string": [0, 2, 5, 7], "form": [0, 2, 5, 7], "famili": [0, 2, 5, 7], "_": [0, 1, 2, 4, 5, 7], "degre": [0, 2, 5, 7], "fiber_spac": [0, 1, 2, 3, 4, 5, 6, 7], "p_2": [0, 1, 6], "microstructur": [0, 2, 5], "sheet_norm": [0, 2, 3, 4, 5, 6, 7], "dolfin_ldrb": [0, 1, 2, 3, 4, 5, 6, 7], "ffun": [0, 1, 2, 3, 4, 5, 6, 7], "store": [0, 2, 5, 6, 7], "file": [0, 1, 2, 3, 4, 5, 7], "built": 0, "xdmf": [0, 2, 3, 4, 5, 6], "viewer": 0, "also": [0, 1, 2, 3, 4, 5, 6], "work": [0, 2, 5], "function": [0, 2, 4, 5, 6, 7], "defin": [0, 7], "quadratur": 0, "fiber_to_xdmf": [0, 1, 2, 5, 6, 7], "And": [0, 1, 2, 3, 4, 5], "visual": [0, 2, 5], "paraview": [0, 2, 5], "In": [0, 1, 2, 5, 6], "order": [0, 1, 7], "need": [0, 4], "have": [0, 3, 4], "fenic": [0, 3, 4, 6], "version": 0, "older": 0, "than": 0, "2016": 0, "ar": [0, 1, 2, 3, 4, 5, 6, 7], "support": [0, 4], "The": [0, 1, 2, 3, 4, 5, 7], "packag": [0, 3, 4, 6, 8], "can": [0, 2, 3, 4, 5, 6], "python": [0, 6], "m": 0, "most": 0, "recent": [0, 3], "sourc": [0, 2, 5, 7], "git": 0, "finsberg": [0, 6], "avail": 0, "forg": 0, "If": [0, 2, 4, 5, 7], "don": [0, 2, 5], "t": [0, 2, 5, 7], "alreadi": 0, "one": [0, 4], "provid": [0, 7], "imag": 0, "e": [0, 2, 4, 5, 7], "pull": 0, "ghcr": 0, "io": 0, "latest": 0, "follow": [0, 2, 5, 7], "command": 0, "contain": [0, 3, 4, 6, 7], "share": 0, "your": 0, "current": 0, "directori": [0, 4], "run": [0, 1, 2, 4, 5, 6], "rm": 0, "v": [0, 2, 5, 7], "pwd": 0, "home": 0, "w": [0, 2, 5, 7], "host": 0, "check": 0, "out": [0, 3, 4], "demo": [0, 1, 2, 3, 4, 5, 6], "under": 0, "gnu": 0, "lgpl": 0, "3": [0, 2, 5, 7], "option": [0, 7], "ani": 0, "later": 0, "copyright": 0, "2011": 0, "2019": 0, "author": 0, "simula": 0, "research": 0, "laboratori": 0, "henrik": 0, "henriknf": 0, "we": [1, 2, 3, 4, 5, 6], "show": [1, 6], "how": [1, 6, 7], "coordin": [1, 7], "longitudin": 1, "circumferenti": [1, 7], "radial": 1, "direct": [1, 7], "These": [1, 2, 4, 5], "vector": [1, 7], "veri": 1, "sever": 1, "applic": 1, "For": 1, "ultrasound": 1, "strain": 1, "estim": 1, "along": 1, "metric": 1, "quantifi": 1, "let": 1, "first": [1, 3, 4, 6, 7], "relev": 1, "librari": [1, 2, 5], "ldrb": [1, 2, 3, 4, 5, 6], "dolfin": [1, 2, 3, 4, 5, 6, 7], "biv": 1, "bit": 1, "tricki": 1, "compar": 1, "case": [1, 2, 5, 7], "depend": 1, "creat": [1, 6, 7], "create_lv_mesh": 1, "els": [1, 4], "create_biv_mesh": 1, "extract": 1, "variabl": 1, "facet": [1, 2, 4, 5, 7], "mark": [1, 2, 5, 7], "boundari": [1, 2, 5, 7], "dictionari": [1, 2, 5, 6, 7], "kei": [1, 2, 5], "valu": [1, 2, 5, 7], "do": [1, 2, 4, 5], "littl": 1, "trick": 1, "where": 1, "me": 1, "find": [1, 6, 7], "algorithm": [1, 3, 4, 6], "again": 1, "some": 1, "differ": [1, 7], "get": [1, 7], "final": 1, "take": 1, "cross": [1, 7], "product": 1, "better": 1, "wai": 1, "pleas": [1, 4], "submit": 1, "pr": 1, "lv_ffun": 1, "meshfunct": [1, 2, 4, 5, 7], "size_t": [1, 2, 4, 5], "arrai": [1, 4, 7], "copi": 1, "lv_marker": 1, "pop": 1, "long": 1, "90": 1, "circ": 1, "rad": 1, "project": [1, 7], "function_spac": 1, "singl": [1, 7], "ventricl": 1, "much": [1, 7], "simpler": 1, "save_mark": [1, 7], "true": [1, 7], "save": [1, 2, 3, 4, 5, 6, 8], "ran": 1, "result": [1, 2, 3, 4, 5], "shown": 1, "figur": 1, "1": [1, 4, 7], "respect": [1, 7], "from": [2, 3, 4, 5, 6, 7], "ideal": [2, 5], "call": [2, 3, 4, 5], "instal": [2, 5], "pip": [2, 5], "i": [2, 5, 7], "note": [2, 3, 4, 5, 6], "requir": [2, 5], "gmsh": [2, 3, 4, 5, 6], "opencascad": 2, "df": [2, 5, 7], "here": [2, 3, 4, 5, 6], "just": [2, 3, 4, 5], "attribut": [2, 5], "load": [2, 3, 4, 5, 7], "underli": [2, 5], "ha": [2, 4, 5], "slightli": [2, 5], "modifi": [2, 5], "expect": [2, 5], "being": [2, 5], "base": [2, 3, 4, 5, 6, 7], "parallel": [2, 4, 5], "should": [2, 5, 7], "serial": [2, 4, 5], "xdmffile": [2, 3, 4, 5, 6], "mpi_comm": [2, 3, 4, 5, 6], "write": [2, 3, 4, 5, 6], "when": [2, 5], "code": [2, 5], "read": [2, 4, 5], "agin": [2, 5], "lagrange_2": 2, "hdf5file": [2, 5], "h5": [2, 5], "h5file": [2, 5, 7], "skip": [2, 5], "step": [2, 5], "stead": [2, 5], "xml": [2, 5], "space_from_str": [2, 5, 7], "dim": [2, 5, 7], "which": [2, 3, 4, 5, 6, 7], "scalar": [2, 5, 6, 7], "glyph": [2, 5], "visualis": [2, 5], "yet": [2, 5], "mpirun": [2, 4, 5], "test": [2, 5], "biv_fib": 2, "biv_sheet": 2, "biv_sheet_norm": 2, "link": [2, 5], "publish": [3, 4], "own": [3, 4], "implement": [3, 4], "thei": [3, 4], "lot": [3, 4], "aim": [3, 4], "try": [3, 4], "lifex": [3, 4], "found": [3, 4], "zenodo": [3, 4], "org": [3, 4], "record": [3, 4], "5810269": [3, 4], "yeejwi8w1b0": [3, 4], "doi": [3, 4], "5281": [3, 4], "assum": [3, 4, 7], "download": [3, 4], "folder": [3, 4, 7], "same": [3, 4], "upload": [3, 4], "so": [3, 4], "locat": [3, 4], "lifex_fiber_generation_exampl": [3, 4], "necessari": [3, 4, 6], "meshio": [3, 6], "msh": [3, 4, 6], "marker_funct": [3, 4, 6], "gmsh2dolfin": [3, 4, 6], "actual": [3, 4], "pars": 3, "wrong": 3, "name": [3, 7], "renam": 3, "them": 3, "ldrb_marker": [3, 6], "basal": [3, 7], "plane": 3, "select": [3, 4, 6], "linear": [3, 4, 6, 7], "lagrang": [3, 4, 6, 7], "element": [3, 4, 6, 7], "p_1": [3, 4], "fiber": [3, 4, 7], "system": [3, 4, 7], "idealized_lv_fib": 3, "pathlib": 4, "path": 4, "larg": 4, "probabl": 4, "done": 4, "make": 4, "sure": 4, "set": [4, 7], "unlink": 4, "fals": [4, 7], "To": 4, "4": 4, "python3": 4, "demo_lifex_strocchi_lv": 4, "py": 4, "processor": 4, "specifi": [4, 7], "output": 4, "outdir": 4, "otherwis": 4, "directli": 4, "mpi": [4, 7], "comm_world": 4, "size": 4, "exit": 4, "is_fil": 4, "rais": [4, 7], "runtimeerror": [4, 7], "f": [4, 7], "as_posix": 4, "onli": 4, "moment": 4, "original_mark": 4, "endo": [4, 5, 6, 7], "20": [4, 7], "aortic_valv": 4, "50": [4, 7], "mitral_valv": 4, "instead": 4, "updat": [4, 6], "accordingli": 4, "01_strocchi_lv_fib": 4, "create_lv_ellipsoid": 5, "altern": 5, "lagrange_1": [5, 7], "lv_fiber": 5, "lv_sheet": 5, "lv_sheet_norm": 5, "orient": [6, 7], "construct": [6, 7], "info": [6, 7], "see": [6, 7], "It": [6, 7], "physic": 6, "surfac": 6, "present": 6, "api": 6, "puls": 6, "within": [6, 7], "patient_fib": 6, "axi": 7, "u": 7, "ndarrai": 7, "given": 7, "two": 7, "apicobas": 7, "transmur": 7, "return": 7, "matrix": 7, "repres": 7, "orthonorm": 7, "basi": 7, "second": 7, "third": 7, "bislerp": 7, "qa": 7, "qb": 7, "float": 7, "interpol": 7, "orthogon": 7, "matric": 7, "q_a": 7, "q_b": 7, "refer": 7, "timepoint": 7, "spheric": 7, "slerp": 7, "compute_fiber_sheet_system": 7, "f0": 7, "s0": 7, "n0": 7, "xdof": 7, "ydof": 7, "zdof": 7, "sdof": 7, "lv_scalar": 7, "rv_scalar": 7, "epi_scalar": 7, "lv_rv_scalar": 7, "lv_gradient": 7, "rv_gradient": 7, "epi_gradi": 7, "apex_gradi": 7, "marker_scalar": 7, "normal": 7, "l2": 7, "paramet": 7, "np": 7, "type": 7, "q": 7, "alpha": 7, "beta": 7, "orthotrop": 7, "canon": 7, "rotat": 7, "align": 7, "determin": 7, "quat2rot": 7, "quaternion": 7, "rot2quat": 7, "q1": 7, "q2": 7, "target": 7, "factor": 7, "between": 7, "class": 7, "fibersheetsystem": 7, "tupl": 7, "alia": 7, "number": 7, "apex_to_bas": 7, "base_mark": 7, "int": 7, "solver": 7, "petsckrylovsolv": 7, "apex": 7, "laplac": 7, "equat": 7, "solut": 7, "meshfunctionsizet": 7, "krylov_solver_atol": 7, "krylov": 7, "converg": 7, "criterion": 7, "term": 7, "absolut": 7, "residu": 7, "default": 7, "1e": 7, "15": 7, "krylov_solver_rtol": 7, "rel": 7, "krylov_solver_max_it": 7, "maximum": 7, "iter": 7, "perform": 7, "10000": 7, "verbos": 7, "bool": 7, "print": 7, "more": 7, "strict": 7, "none": 7, "ksp_monitor": 7, "ksp_view": 7, "pc_view": 7, "str": 7, "check_boundaries_are_mark": 7, "list": 7, "dof": 7, "65": 7, "25": 7, "all": 7, "freedom": 7, "dofs_from_function_spac": 7, "cg_1": 7, "log_level": 7, "what": 7, "calcul": 7, "itself": 7, "must": 7, "vale": 7, "debug": 7, "warn": 7, "doe": 7, "sum": 7, "nice": 7, "correctli": 7, "kwarg": 7, "keyword": 7, "argument": 7, "possibl": 7, "howev": 7, "either": 7, "taken": 7, "origin": 7, "paper": 7, "alpha_": 7, "text": 7, "beta_": 7, "fiber_system_to_dolfin": 7, "numpi": 7, "find_cases_and_boundari": 7, "solv": 7, "gradient": 7, "project_gradi": 7, "scalar_solut": 7, "scalar_laplacian": 7, "laplacian": 7, "standard_dof": 7, "standard": 7, "length": 7, "dolfin_to_hd5": 7, "obj": 7, "h5name": 7, "time": 7, "comm": 7, "mpi4pi": 7, "intracomm": 7, "object": 7, "hdf": 7, "h5group": 7, "withing": 7, "fun": 7, "fname": 7, "fun_to_xdmf": 7, "load_dict_from_h5": 7, "save_scalar_funct": 7, "file_mod": 7, "save_vector_funct": 7, "projector": 7, "functionspac": 7, "solver_typ": 7, "lu": 7, "preconditioner_typ": 7, "expr": 7, "param": 7, "ufl": 7, "express": 7, "core": 7, "assign_to_vector": 7, "assign": 7, "broadcast": 7, "from_process": 7, "process": 7, "default_mark": 7, "distribut": 7, "gather": 7, "on_process": 7, "flatten": 7, "gather_broadcast": 7, "arr": 7, "mpi_comm_world": 7, "space_str": 7, "finit": 7, "represent": 7, "value_s": 7, "coeffici": 7, "union": 7, "submodul": 8, "calculu": 8, "modul": 8, "util": 8, "content": 8}, "objects": {"": [[7, 0, 0, "-", "ldrb"]], "ldrb": [[7, 0, 0, "-", "calculus"], [7, 1, 1, "", "dolfin_ldrb"], [7, 1, 1, "", "fiber_to_xdmf"], [7, 1, 1, "", "fun_to_xdmf"], [7, 0, 0, "-", "ldrb"], [7, 1, 1, "", "project_gradients"], [7, 0, 0, "-", "save"], [7, 1, 1, "", "scalar_laplacians"], [7, 1, 1, "", "space_from_string"], [7, 0, 0, "-", "utils"]], "ldrb.calculus": [[7, 1, 1, "", "axis"], [7, 1, 1, "", "bislerp"], [7, 1, 1, "", "compute_fiber_sheet_system"], [7, 1, 1, "", "normalize"], [7, 1, 1, "", "orient"], [7, 1, 1, "", "quat2rot"], [7, 1, 1, "", "rot2quat"], [7, 1, 1, "", "slerp"]], "ldrb.ldrb": [[7, 2, 1, "", "FiberSheetSystem"], [7, 1, 1, "", "apex_to_base"], [7, 1, 1, "", "bayer"], [7, 1, 1, "", "check_boundaries_are_marked"], [7, 1, 1, "", "compute_fiber_sheet_system"], [7, 1, 1, "", "dofs_from_function_space"], [7, 1, 1, "", "dolfin_ldrb"], [7, 1, 1, "", "fiber_system_to_dolfin"], [7, 1, 1, "", "find_cases_and_boundaries"], [7, 1, 1, "", "laplace"], [7, 1, 1, "", "project_gradients"], [7, 1, 1, "", "scalar_laplacians"], [7, 1, 1, "", "standard_dofs"]], "ldrb.ldrb.FiberSheetSystem": [[7, 3, 1, "", "fiber"], [7, 3, 1, "", "sheet"], [7, 3, 1, "", "sheet_normal"]], "ldrb.save": [[7, 1, 1, "", "dolfin_to_hd5"], [7, 1, 1, "", "fiber_to_xdmf"], [7, 1, 1, "", "fun_to_xdmf"], [7, 1, 1, "", "load_dict_from_h5"], [7, 1, 1, "", "save_scalar_function"], [7, 1, 1, "", "save_vector_function"]], "ldrb.utils": [[7, 2, 1, "", "Projector"], [7, 1, 1, "", "assign_to_vector"], [7, 1, 1, "", "broadcast"], [7, 1, 1, "", "default_markers"], [7, 1, 1, "", "distribution"], [7, 1, 1, "", "gather"], [7, 1, 1, "", "gather_broadcast"], [7, 1, 1, "", "mpi_comm_world"], [7, 1, 1, "", "space_from_string"], [7, 1, 1, "", "value_size"]], "ldrb.utils.Projector": [[7, 4, 1, "", "project"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:attribute", "4": "py:method"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "method", "Python method"]}, "titleterms": {"laplac": 0, "dirichlet": 0, "rule": 0, "base": 0, "ldrb": [0, 7, 8], "algorithm": 0, "assign": 0, "myocardi": 0, "fiber": [0, 2, 5, 6], "orient": 0, "instal": 0, "pip": 0, "conda": 0, "docker": 0, "document": 0, "get": 0, "start": 0, "licens": 0, "contributor": 0, "local": 1, "basi": 1, "function": 1, "creat": [2, 5], "simpl": [2, 5], "biv": 2, "ellipsoid": [2, 5], "life": [3, 4], "x": [3, 4], "idealized_lv": 3, "01_strocchi_lv": 4, "lv": 5, "gener": 6, "patient": 6, "specif": 6, "geometri": 6, "packag": 7, "submodul": 7, "calculu": 7, "modul": 7, "save": 7, "util": 7, "content": 7}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})